import se.nbis.lega.deployment.test.EncryptFileTask
import se.nbis.lega.deployment.test.GenerateFileTask
import se.nbis.lega.deployment.test.IngestFileTask
import se.nbis.lega.deployment.test.UploadFileTask

task purge() {
    setGroup "swarm"

    dependsOn ":lega:removeVolumes"
}

task clean() {
    setGroup "swarm"

    dependsOn ":cega:clearConfiguration", ":lega:clearConfiguration"
    doLast {
        new File(".tmp").deleteDir()
    }
}

task bootstrap() {
    setGroup "swarm"

    dependsOn ":cega:createConfiguration", ":lega:createConfiguration"
}

task deploy() {
    setGroup "swarm"

    dependsOn ":cega:deployStack", ":lega:deployStack"
}

task rm() {
    setGroup "swarm"

    doLast {
        exec {
            executable "docker"
            args "stack", "rm", "lega"
        }
        sleep 10000
        exec {
            executable "docker"
            args "stack", "rm", "cega"
        }
    }
}

task ls() {
    setGroup "swarm"

    doLast {
        exec {
            executable "docker"
            args "service", "list"
        }
    }
}

task file(type: GenerateFileTask)

task encrypt(type: EncryptFileTask)

task upload(type: UploadFileTask)

task ingest(type: IngestFileTask)
